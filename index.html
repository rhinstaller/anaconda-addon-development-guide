<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns:d="http://docbook.org/ns/docbook">Anaconda Addon Development Guide</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta xmlns:d="http://docbook.org/ns/docbook" name="generator" content="publican v4.2.6" /><meta xmlns:d="http://docbook.org/ns/docbook" name="package" content="Fedora-Anaconda_Addon_Development_Guide-22-en-US-2-0" /><meta name="description" content="The Anaconda installer is a piece of software used to install Fedora, Red Hat Enterprise Linux and their derivatives. Since the installation is internally a complicated process and there are many aspects of the resulting system that need to be configured during installation it has been decided that the Anaconda installer needs to support dynamically loaded plugins (addons) that will be developed and maintained by other teams and people specialized in certain areas. This guide should help those people writting an Anaconda addon to get an insight to the architecture and basic principles used by the Anaconda installer as well as an overview of the API and helper functions provided." /><link rel="home" href="index.html" title="Anaconda Addon Development Guide" /><link rel="next" href="sect-anaconda-addon-architecture.html" title="2. Architecture of Anaconda" /></head><body class="draft "><p id="title"><a class="left" href="http://www.fedoraproject.org"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="http://docs.fedoraproject.org"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><ul class="docnav top"><li class="previous"></li><li class="home">Anaconda Addon Development Guide</li><li class="next"><a accesskey="n" href="sect-anaconda-addon-architecture.html"><strong>Next</strong></a></li></ul><div xml:lang="en-US" class="article" lang="en-US"><div class="titlepage"><div><div class="producttitle" font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><span xmlns:d="http://docbook.org/ns/docbook" class="productname">Fedora</span> <span xmlns:d="http://docbook.org/ns/docbook" class="productnumber">22</span></div><div><h2 class="title"><a id="idm242215022416">
      ⁠</a>Anaconda Addon Development Guide</h2></div><div><h3 class="subtitle"><em>Things one needs to know when writing an Anaconda installer Addon</em></h3></div><div><h3 class="corpauthor">
		<span class="inlinemediaobject"><object data="Common_Content/images/title_logo.svg" type="image/svg+xml"><img src="Common_Content/images/title_logo.png" alt="" /></object></span>

	</h3></div><div><div xml:lang="en-US" class="authorgroup" lang="en-US"><div class="author"><h3 class="author"><span class="firstname">Vratislav</span> <span class="surname">Podzimek</span></h3><code class="email"><a class="email" href="mailto:vpodzime@redhat.com">vpodzime@redhat.com</a></code></div><div class="editor"><h4 class="editedby">Edited by</h4><h3 class="editor"><span class="firstname">Petr</span> <span class="surname">Bokoč</span></h3><code class="email"><a class="email" href="mailto:pbokoc@redhat.com">pbokoc@redhat.com</a></code></div></div></div><div><div class="legalnotice"><a id="idm242208117440"></a><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"></span>© 2015 Fedora Project Contributors.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. The original authors of this document, and Red Hat, designate the Fedora Project as the "Attribution Party" for purposes of CC-BY-SA. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, JBoss, MetaMatrix, Fedora, the Infinity Logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		For guidelines on the permitted uses of the Fedora trademarks, refer to <a href="https://fedoraproject.org/wiki/Legal:Trademark_guidelines">https://fedoraproject.org/wiki/Legal:Trademark_guidelines</a>.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
			The Anaconda installer is a piece of software used to install Fedora, Red Hat Enterprise Linux and their derivatives. Since the installation is internally a complicated process and there are many aspects of the resulting system that need to be configured during installation it has been decided that the Anaconda installer needs to support dynamically loaded plugins (addons) that will be developed and maintained by other teams and people specialized in certain areas. This guide should help those people writting an Anaconda addon to get an insight to the architecture and basic principles used by the Anaconda installer as well as an overview of the API and helper functions provided.
		</div></div></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="index.html#sect-anaconda-addon-introduction">1. Introduction to Anaconda and Add-ons</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#sect-anaconda-introduction">1.1. Introduction to Anaconda</a></span></dt><dt><span class="section"><a href="index.html#sect-firstboot-introduction">1.2. Firstboot and Initial Setup</a></span></dt><dt><span class="section"><a href="index.html#sect-anaconda-introduction-addons">1.3. Anaconda and Initial Setup Add-ons</a></span></dt><dt><span class="section"><a href="index.html#sect-anaconda-introduction-additional-information">1.4. Additional Information</a></span></dt></dl></dd><dt><span class="section"><a href="sect-anaconda-addon-architecture.html">2. Architecture of Anaconda</a></span></dt><dt><span class="section"><a href="sect-anaconda-hub-and-spoke.html">3. The Hub &amp; Spoke model</a></span></dt><dt><span class="section"><a href="sect-anaconda-threads-communication.html">4. Threads and Communication</a></span></dt><dt><span class="section"><a href="sect-anaconda-addon-structure.html">5. Anaconda Add-on Structure</a></span></dt><dt><span class="section"><a href="sect-writing-anaconda-addon.html">6. Writing an Anaconda add-on</a></span></dt><dd><dl><dt><span class="section"><a href="sect-writing-anaconda-addon.html#sect-anaconda-addon-kickstart-support">6.1. Kickstart Support</a></span></dt><dt><span class="section"><a href="sect-anaconda-addon-gui-support.html">6.2. Graphical user interface</a></span></dt><dt><span class="section"><a href="sect-anaconda-addon-tui-support.html">6.3. Text User Interface</a></span></dt></dl></dd><dt><span class="section"><a href="sect-anaconda-addon-deploying-testing.html">7. Deploying and Testing an Anaconda Add-on</a></span></dt><dt><span class="section"><a href="sect-addons-welcome.html">8. Add-ons Welcome</a></span></dt><dt><span class="appendix"><a href="appe-Anaconda_Addon_Development_Guide-Revision_History.html">A. Revision History</a></span></dt><dt><span class="index"><a href="ix01.html">Index</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h2 class="title"><a id="sect-anaconda-addon-introduction">
      ⁠</a>1. Introduction to Anaconda and Add-ons</h2></div></div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="sect-anaconda-introduction">
      ⁠</a>1.1. Introduction to Anaconda</h3></div></div></div><div class="para">
				<span class="application"><strong>Anaconda</strong></span> is the operating system installer used in Fedora, Red Hat Enterprise Linux, and their derivatives. It is a set of Python modules and scripts together with some additional files like <code class="systemitem">Gtk</code> widgets (written in C), <code class="systemitem">systemd</code> units, and <code class="systemitem">dracut</code> libraries. Together, they form a tool that allows users to set parameters of the resulting (target) system and then set such a system up on a machine. The installation process has four major steps:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						installation destination preparation (usually disk partitioning)
					</div></li><li class="listitem"><div class="para">
						package and data installation
					</div></li><li class="listitem"><div class="para">
						boot loader installation and configuration
					</div></li><li class="listitem"><div class="para">
						configuration of the newly installed system
					</div></li></ul></div><div class="para">
				There are three ways you can control the installer and specify installation options. The most common approach is to use the <em class="firstterm">graphical user interface</em> (GUI). This interface is meant to allow users to install the system interactively with little or no configuration required before beginning the installation, and it should cover all common use cases, including setting up complicated partitioning layouts.
			</div><div class="para">
				The graphical interface also supports remote access over <code class="systemitem">VNC</code>, which allows you to use the GUI even on systems with no graphics cards or even attached monitor. However, there are still cases where this is not desired, but at the same time, you may want to perform an interactive installation. For these cases, a <em class="firstterm">text mode</em> (TUI) is available. The TUI works in a way similar to a monochrome line printer, which allows it to work even on serial consoles which do not support cursor movement, colors and other advanced features. The text mode is limited in that it only allows you to customize most common options, such as network settings, language options or installation (package) source; advanced features such as manual partitioning are not available in this interface.
			</div><div class="para">
				The third way to install a system using <span class="application"><strong>Anaconda</strong></span> is by using a Kickstart file - a plain text file with shell-like syntax which can contain data to drive the installation process. A Kickstart file allows you to partially or completely automate the installation. A certain set of commands which configures all required areas is necessary to completely automate the installation; if one or more of the required commands is missing, the installation will require interaction. If all required commands are present, the installation will be performed in a completely automatic way, without any need for interaction.
			</div><div class="para">
				Kickstart provides the highest amount of options, covering use cases where neither the TUI nor the GUI is sufficient. Every feature in <span class="application"><strong>Anaconda</strong></span> must always be supported in Kickstart; other interfaces follow only subsets of all available options, which allows them to remain clear.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="sect-firstboot-introduction">
      ⁠</a>1.2. Firstboot and Initial Setup</h3></div></div></div><div class="para">
				The first boot of the newly installed system is traditionally considered a part of the installation process as well, because some parts of configuration such as user creation are often performed at this point. In older releases of Red Hat Enterprise Linux, the <span class="application"><strong>Firstboot</strong></span> tool has been used for this purpose, allowing you to register your newly installed system or configure <span class="application"><strong>Kdump</strong></span>. However, <span class="application"><strong>Firstboot</strong></span> relies on no longer maintained tools such as <code class="systemitem">Gtk2</code> and the <code class="systemitem">pygtk2</code> module. <a id="idm242216101760">
      ⁠</a><a xmlns:d="http://docbook.org/ns/docbook" href="#ftn.idm242216101760" class="footnote"><sup class="footnote">[1]</sup></a> For this reason, a new tool called <span class="application"><strong>Initial Setup</strong></span> was developed, which reuses code from <span class="application"><strong>Anaconda</strong></span>. This allows add-ons developed for <span class="application"><strong>Anaconda</strong></span> to be easily reused in <span class="application"><strong>Initial Setup</strong></span>. This topic is further discussed in <a class="xref" href="sect-writing-anaconda-addon.html">Section 6, “Writing an Anaconda add-on”</a>.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="sect-anaconda-introduction-addons">
      ⁠</a>1.3. Anaconda and Initial Setup Add-ons</h3></div></div></div><div class="para">
				Installing a new operating system is a vastly complicated use case - each user may want to do something slightly different. Designing an installer for every corner case would cause it to be cluttered with rarely-used functionality. For this reason, when the installer was being rewritten into its current form, it gained support for add-ons.
			</div><div class="para">
				<span class="application"><strong>Anaconda</strong></span> add-ons can be used to add your own Kickstart commands and options as well as new configuration screens in the graphical and text-based user interface, depending on your specific use case. Each add-on must have Kickstart support; the GUI and TUI are optional, but can be very helpful.
			</div><div class="para">
				In current releases of Fedora <a id="idm242216144480">
      ⁠</a><a xmlns:d="http://docbook.org/ns/docbook" href="#ftn.idm242216144480" class="footnote"><sup class="footnote">[2]</sup></a> (21 and later) and Red Hat Enterprise Linux (7.1 and later), one add-on is included by default: The <span class="application"><strong>Kdump</strong></span> add-on, which adds support for configuring kernel crash dumping during the installation. This add-on has full support in Kickstart (using the <code class="command">%addon com_redhat_kdump</code> command and its options) and is fully integrated as an additional screen in the text-based and graphical interfaces. You can develop other add-ons in the same way and add them to the default installer using procedures described further in this guide.
			</div></div><div class="section"><div class="titlepage"><div><div keep-together.within-column="always"><h3 class="title"><a id="sect-anaconda-introduction-additional-information">
      ⁠</a>1.4. Additional Information</h3></div></div></div><div class="para">
				Following links contain additional information about <span class="application"><strong>Anaconda</strong></span> and <span class="application"><strong>Initial Setup</strong></span>:
			</div><div xmlns:d="http://docbook.org/ns/docbook" class="itemizedlist"><ul><li class="listitem"><div class="para">
						The <a href="http://fedoraproject.org/wiki/Anaconda">Anaconda page on Fedora Project Wiki</a> contains provides more information about the installer.
					</div></li><li class="listitem"><div class="para">
						Information about development of <span class="application"><strong>Anaconda</strong></span> into its current version is available at the <a href="https://fedoraproject.org/wiki/Anaconda/NewInstaller">Anaconda/NewInstaller Wiki page</a>.
					</div></li><li class="listitem"><div class="para">
						Chapters <a href="https://docs.fedoraproject.org/en-US/Fedora/22/html/Installation_Guide/chap-kickstart-installations.html">Automating the Installation with Kickstart</a> and <a href="https://docs.fedoraproject.org/en-US/Fedora/22/html/Installation_Guide/appe-kickstart-syntax-reference.html">Kickstart Syntax Reference</a> of the <em class="citetitle">Fedora Installation Guide</em> provide full documentation of Kickstart, including a list of all supported commands and options.
					</div></li><li class="listitem"><div class="para">
						The <a href="https://docs.fedoraproject.org/en-US/Fedora/22/html/Installation_Guide/chap-installing-using-anaconda.html">Installing Using Anaconda</a> chapter of the <em class="citetitle">Fedora Installation Guide</em> describes the installation process in the graphical and text user interfaces.
					</div></li><li class="listitem"><div class="para">
						For information about tools used for after-installation configuration, see <a href="https://docs.fedoraproject.org/en-US/Fedora/22/html/Installation_Guide/chap-after-installation.html#sect-initial-setup">Initial Setup</a>.
					</div></li></ul></div></div></div><div class="footnotes"><br /><hr /><div id="ftn.idm242216101760" class="footnote"><div class="para"><a href="#idm242216101760" class="para"><sup class="para">[1] </sup></a>
					While Firstboot is a legacy tool, it is still supported because of third-party modules written for it.
				</div></div><div id="ftn.idm242216144480" class="footnote"><div class="para"><a href="#idm242216144480" class="para"><sup class="para">[2] </sup></a>
					In Fedora, the add-on is disabled by default. You can enable it using the <code class="option">inst.kdump_addon=on</code> option in the boot menu.
				</div></div></div></div><ul class="docnav"><li class="previous"></li><li class="next"><a accesskey="n" href="sect-anaconda-addon-architecture.html"><strong>Next</strong>2. Architecture of Anaconda</a></li></ul></body></html>